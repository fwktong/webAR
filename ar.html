<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <title>AR 體驗</title>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <meta name="description" content="使用 A-Frame 與 AR.js 的 Web AR 體驗頁面。" />
    <link rel="stylesheet" href="styles.css" />

    <!-- A-Frame 與 AR.js（建議版本：1.4.1 與 AR.js 3.4.4 相對穩定） -->
    <script src="https://aframe.io/releases/1.4.1/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js@3.4.4/aframe/build/aframe-ar.js"></script>

    <!-- AR 頁面專用邏輯 -->
    <script src="ar.js" defer></script>
  </head>
  <body class="ar-body">
    <div id="ar-root">
      <!-- AR 不支援時的簡易訊息 -->
      <div id="ar-unsupported" class="ar-unsupported hidden">
        <h2>此裝置或瀏覽器可能不支援 Web AR</h2>
        <p>
          請確認：
        </p>
        <ul>
          <li>使用最新版 Safari / Chrome 手機瀏覽器。</li>
          <li>已透過 HTTPS 開啟本網站。</li>
          <li>允許瀏覽器存取相機權限。</li>
        </ul>
      </div>

      <!-- A-Frame + AR.js 場景 -->
      <a-scene
        id="ar-scene"
        embedded
        vr-mode-ui="enabled: false"
        renderer="logarithmicDepthBuffer: true; antialias: true; alpha: true;"
        arjs="sourceType: webcam; debugUIEnabled: false; trackingMethod: best; videoTexture: true; displayWidth: 1280; displayHeight: 720; maxDetectionRate: 30; cameraParametersUrl: https://cdn.jsdelivr.net/gh/AR-js-org/AR.js@3.4.4/data/data/camera_para.dat;"
      >
        <a-assets>
          <!-- 綠幕影片：可替換為自己的影片 URL -->
          <!-- 注意：影片需允許跨來源播放，並建議使用 mp4 (H.264 + AAC) -->
          <video
            id="greenscreen-video"
            src="https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4"
            loop
            crossorigin="anonymous"
            playsinline
            webkit-playsinline
          ></video>
        </a-assets>

        <!-- Hiro 標記：在此標記上顯示去背影片 -->
        <a-marker preset="hiro" id="hiro-marker">
          <!-- 使用自訂 chroma-key shader，將綠色背景去除 -->
          <!-- position="0 0.1 0" 表示在標記上方 0.1 單位，rotation="-90 0 0" 表示平躺 -->
          <a-plane
            id="video-plane"
            position="0 0.15 0"
            rotation="-90 0 0"
            width="1.5"
            height="1.0"
            material="shader: chroma-key; src: #greenscreen-video; keyColor: 0.0 1.0 0.0; similarity: 0.4; smoothness: 0.1; side: double;"
            visible="true"
          ></a-plane>
        </a-marker>

        <!-- AR 相機 -->
        <a-entity camera></a-entity>
      </a-scene>

      <!-- 底部控制列 UI -->
      <div class="ar-ui-bottom">
        <button id="btn-back" class="secondary-btn">
          ⬅ 返回首頁
        </button>
        <button id="btn-photo" class="circle-btn">
          📷
        </button>
        <button id="btn-record" class="circle-btn record-btn">
          ⏺
        </button>
        <div class="timer-label">
          <span id="record-timer">00:00</span>
          <span class="timer-max">/ 00:30</span>
        </div>
      </div>
    </div>

    <!-- 簡易載入中遮罩 -->
    <div id="loading-overlay" class="loading-overlay">
      <div class="loading-box">
        <div class="spinner"></div>
        <p>正在啟動 AR 相機，請稍候…</p>
      </div>
    </div>
  </body>
</html>






